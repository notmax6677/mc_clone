optimize chunk create functionality and organize the code
